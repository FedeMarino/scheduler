<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Visual Time Scheduler</title>
    <link rel="stylesheet" href="style.css">
    <!-- Font Awesome for Icons (Optional) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="main-wrapper">
        <!-- Control Bar Section -->
        <div class="control-bar card">
            <!-- Task Creation Area -->
            <div class="task-creation">
                <h3>
                    <span id="task-form-title">Add New Task</span>
                    <button id="cancel-edit-btn" class="edit-mode-only action-button secondary" style="display: none;">Cancel Edit</button>
                 </h3>
                <form id="task-form" class="task-input">
                    <input type="text" id="task-name" placeholder="Task Name" required>
                    <select id="task-duration" required>
                        <!-- Duration options generated by JS -->
                    </select>
                    <input type="color" id="task-color" value="#fef4e5" title="Task color">
                    <button type="submit" id="add-task-btn" class="action-button primary">Add</button>
                </form>
            </div>

            <!-- Schedule Controls Area (Expandable) -->
            <div class="schedule-controls">
                <h3 id="view-range-toggle" class="expandable-toggle" title="Click to toggle view range options">
                    Schedule View Range <span>&#9662;</span>
                </h3>
                <div id="view-range-options" class="expandable-content">
                    <label for="start-hour">Start:</label>
                    <select id="start-hour"></select>
                    <label for="end-hour">End:</label>
                    <select id="end-hour"></select>
                    <button id="update-schedule-view" class="action-button primary">Update View</button>
                </div>
            </div>

            <!-- Data Management Area -->
            <div class="data-management">
                 <h3>Actions</h3>
                 <div class="action-buttons-group">
                     <button id="clear-schedule-btn" class="action-button danger" title="Move all scheduled tasks back to the pool">Clear Schedule</button>
                     <button id="save-state-btn" class="action-button secondary" title="Save current tasks and schedule to a file">Save State</button>
                     <button id="load-state-btn" class="action-button secondary" title="Load tasks and schedule from a file">Load State</button>
                     <!-- Hidden file input for loading -->
                     <input type="file" id="load-state-input" accept=".json" style="display: none;">
                 </div>
            </div>

             <!-- Time Summary Area -->
             <div class="time-summary">
                 <p>Scheduled: <span id="total-scheduled-time">0.0 h</span></p>
                 <p>Free in View: <span id="total-free-time">0.0 h</span></p>
             </div>
        </div>

        <!-- Main Content Area (Pool and Schedule) -->
        <div class="content-area">
            <div class="task-pool-container card">
                <h2>Unscheduled Tasks</h2>
                <div id="unscheduled-tasks" class="task-list dropzone">
                    <!-- Unscheduled tasks dynamically added -->
                </div>
            </div>

            <div class="schedule-display-area card">
                 <h2>Today's Schedule</h2>
                 <div class="timeline-wrapper">
                     <div id="drop-indicator"></div>
                    <div id="schedule-timeline" class="timeline dropzone">
                        <!-- Time markers & Scheduled tasks dynamically positioned/prepended -->
                    </div>
                </div>
            </div>
        </div>

    </div><!-- End Main Wrapper -->

     <!-- Floating element for touch drag visualization -->
     <div id="touch-drag-ghost" style="position: fixed; display: none; pointer-events: none; z-index: 1000; opacity: 0.7;"></div>

    <script src="script.js"></script>
</body>
</html>